var win,doc,isScope,_fetch,csp,slice$=[].slice;function import$(e,t){var n,r={}.hasOwnProperty;for(n in t)r.call(t,n)&&(e[n]=t[n]);return e}function in$(e,t){for(var n=-1,r=t.length>>>0;++n<r;)if(e===t[n])return!0;return!1}isScope=function(e){return/^:scope[ .:\[#]|^:scope$/.exec(e)},_fetch=function(e,t){return"undefined"==typeof fs||null===fs||/^https:/.exec(e)?fetch(e,t).then(function(s){var e;return s&&s.ok?s.text():s?s.clone().text().then(function(e){var t,n=s.status||404,r=new Error(n+" "+e);r.name="lderror",r.id=n,r.message=e,n=r;try{(t=JSON.parse(e))&&"lderror"===t.name&&(import$(n,t).json=t)}catch(e){0}return Promise.reject(n)}):Promise.reject(((e=new Error("404")).name="lderror",e.id=404,e))}):new Promise(function(n,r){return fs.readFile(e,function(e,t){return e?r(e):n(t.toString())})})},(csp=function(e,t,n,r){return csp.default||(csp.default=new csp.converter),csp.default.convert(e,t,n,r)}).env=function(e){e=[e,e.document];return win=e[0],doc=e[1],e},csp.id=function(e){return e.id||e.url||(e.ns?e.ns+":":"")+e.name+"@"+(e.version||"main")+":"+(e.path||"index.html")},csp.scope=function(e){return e.scope||"_"+btoa(csp.id(e)).replace(/=/g,"_")},csp._cache={},csp._ver={map:{},list:{}},csp.cache=function(e){var t,n,r,s,i,c,o,a;if((e="string"==typeof e?{url:e}:e).id||(e.id=csp.id(e)),t=this._cache[e.id])return t;if(i=(s=(r=(n=e.id&&!e.name?(n=/^(\S+)@(\S+):(\S+)$/.exec(e.id))?[n[1],n[2],n[3]]:[e.id,"",""]:[e.name,e.version||"",e.path||""])[0],n[1]),n[2]),/^[0-9.]+$/.exec(s)){if((t=((n=this._ver.map)[r]||(n[r]={}))[s])&&(s=t),t=this._cache[csp.id({name:r,version:s,path:i})])return t;for(c=0,o=((n=this._ver.list)[r]||(n[r]=[])).length;c<o;++c)if(a=c,a=this._ver.list[r][a],semver.fit(a,s)&&(this._ver.map[r][s]=a,e.id=csp.id({name:r,version:a,path:i}),t=this._cache[e.id]))return t}return in$(s,(n=this._ver.list)[r]||(n[r]=[]))||this._ver.list[r].push(s),this._cache[e.id]=e},csp.converter=function(e){return this.scopeTest=(e=null==e?{}:e).scopeTest,this.node=doc.createElement("style"),this.iframe=e=doc.createElement("iframe"),e.setAttribute("title","for csscope parsing"),e.style.display="none",e.src="about:blank",doc.body.appendChild(e),this.iframe.contentDocument.body.appendChild(this.node),this._idx=0,this},csp.converter.prototype=import$(Object.create(Object.prototype),{getNames:function(e,t){var n,r,s;for(null==t&&(t={}),n=0,r=e.length;n<r;++n)(s=e[n]).name?t[s.name]=!0:s.cssRules&&this.getNames(s.cssRules,t);return t},_convert:function(e,s,t,i,n){var r,c,o,a,u,p;for(null==n&&(n={}),r="",c=0,o=e.length;c<o;++c)(a=e[c]).style&&(n[a.style.animationName]?a.style.animationName=t+"__"+a.style.animationName:a.style.animation&&(a.style.animation=a.style.animation.split(" ").map(l).join(" "))),a.selectorText?(r+=(u=(i?a.selectorText.split(",").map(d).map(m):a.selectorText.split(",").map(h).map(f)).join(","))+"{"+a.style.cssText+"}",a.selectorText=u):a.name?(u=a.name.split(",").map(y).map(v).join(","),r+="@keyframes "+(a.name=u)+" {\n  "+Array.from(a.cssRules).map(_).join("\n")+"\n}"):a.cssRules&&(p=this._convert(a.cssRules,s,t,i,n),r+="@media "+a.conditionText+" {\n  "+p+"\n}");return r;function l(e){return n[e]?t+"__"+e:e}function h(e){return e.trim()}function f(e){return isScope(e)?e.replace(/^:scope/,s):s+" "+e}function d(e){return e.trim()}function m(e){var t,n,r;return isScope(e)?e.replace(/^:scope/,s):(n=(r=e.split(" ").map(function(e){return e.trim()}).filter(function(e){return e}))[0],t=slice$.call(r,1),n=(r=/^[a-zA-Z]/.exec(n)?[n,""]:["",n])[0],r=r[1],/:[a-z-]+$/.exec(e)?s+" :not("+i+") "+e+","+s+" > "+n+r+" "+t.join(" "):s+" :not("+i+") "+e+","+s+" > "+n+":not("+i+")"+r+" "+t.join(" "))}function y(e){return e.trim()}function v(e){return t+"__"+e}function _(e){return e.cssText}},convert:function(e,t,n,r){var s,e="object"==typeof e?e:{name:e,css:t,rule:n,scopeTest:r},t=e.name,n=e.css,r=e.rule,e=e.scopeTest;return r=r||"."+t,t=t||r,e=e||this.scopeTest,n="object"==typeof n?n:(this.node.textContent=(n||"")+("/*"+this._idx++)+"*/",this.node.sheet.cssRules),s=this.getNames(n,{}),this._convert(n,r,t,e,s)||""}}),csp.manager=function(e){return null==e&&(e={}),this.attrName="csscope",this._cache={},this.converter=new csp.converter,this.counter=0,this.registry(e.registry||"/assets/lib/"),this.init(),this},csp.manager.prototype=import$(Object.create(Object.prototype),{cache:function(e){var t;return(e="string"==typeof e?{url:e}:e).id||(e.id=csp.id(e)),(t=this._cache[e.id])?t:this._cache[e.id]=csp.cache(e)},_ref:function(e){var t;return"string"==typeof e?e:(t=e.url)?t:this._reg.fetch?this._reg.fetch(e):this._reg(e)},registry:function(e){return"string"==typeof e?("/"===e[e.length-1]&&(e=e.substring(0,e.length-1)),this._reg=(t=e,function(e){return t+"/"+e.name+"/"+(e.version||"main")+"/"+(e.path||"index.min.css")})):this._reg=e;var t},init:function(){if(!this.inited)return this.inited=!0,this.styleNode=doc.createElement("style"),this.styleNode.setAttribute("type","text/css"),this.styleNode.setAttribute("data-name","csscope.manager"),this.styleContent=[],doc.body.appendChild(this.styleNode)},scope:function(e,t){t=this.get(t=null==t?[]:t);return e.classList.add.apply(e.classList,t.map(function(e){return e.scope})),t},get:function(e){var t=this;return null==e&&(e=[]),(Array.isArray(e)?e:[e]).map(function(e){return t.cache(e)}).filter(function(e){return e.scope})},load:function(e,n,t){var r,s=this;return e=(Array.isArray(e)?e:[e]).map(function(e){return s.cache(e)}),r=[],Promise.all(e.map(function(t){var e;return t.inited?Promise.resolve():t.scope&&t.code?(t.inited=!0,r.push(t.code),Promise.resolve()):((e=s._ref(t)).then?e.then(function(e){return s.cache((t.id=void 0,t.version=e.version,t)),e}):_fetch(e,{method:"GET"}).then(function(e){return{content:e}})).then(function(e){e=e.content;return t.inited=!0,t.scope=csp.scope(t),t.code=s.converter.convert({css:e,name:t.scope,scopeTest:n}),r.push(t.code)})})).then(function(){return t?e:(s.styleContent.push.apply(s.styleContent,r),s.styleNode.textContent=s.styleContent.join("\n"),s.get(e))})}}),csp.env("undefined"!=typeof self&&null!==self?self:globalThis),"undefined"!=typeof module&&null!==module?module.exports=csp:"undefined"!=typeof window&&null!==window&&(window.csscope=csp);
