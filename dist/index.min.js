!function(){var s,b=[].slice;function t(t,e){var n,r={}.hasOwnProperty;for(n in e)r.call(e,n)&&(t[n]=e[n]);return t}((s=function(t,e,n,r){return(s.default=!s.default?new s.converter:s.default).convert(t,e,n,r)}).converter=function(t){return this.scopeTest=(t=null==t?{}:t).scopeTest,this.node=document.createElement("style"),this.iframe=document.createElement("iframe"),this.iframe.setAttribute("title","for csscope css parsing"),this.iframe.style.display="none",this.iframe.src="about:blank",document.body.appendChild(this.iframe),this.iframe.contentDocument.body.appendChild(this.node),this}).prototype=t(Object.create(Object.prototype),{getNames:function(t,e){var n,r,s;for(null==e&&(e={}),n=0,r=t.length;n<r;++n)(s=t[n]).name?e[s.name]=!0:s.cssRules&&this.getNames(s.cssRules,e);return e},_convert:function(t,s,e,i,n){var r,o,c,u,a,l;for(null==n&&(n={}),r="",o=0,c=t.length;o<c;++o)(u=t[o]).style&&n[u.style.animationName]&&(u.style.animationName=e+"__"+u.style.animationName),u.selectorText?(r+=(a=(i?u.selectorText.split(",").map(f).map(h):u.selectorText.split(",").map(p).map(m)).join(","))+" {\n  "+Array.from(u.style).map(d).join(";")+"\n}",u.selectorText=a):u.name?(a=u.name.split(",").map(y).map(g).join(","),r+="@keyframes "+(u.name=a)+" {\n  "+Array.from(u.cssRules).map(v).join("\n")+"\n}"):u.cssRules&&(l=this._convert(u.cssRules,s,e,i,n),r+="@media "+u.conditionText+" {\n  "+l+"\n}");return r;function p(t){return t.trim()}function m(t){return":scope"===t?s:s+" "+t}function f(t){return t.trim()}function h(t){var e,n,r;return":scope"===t?s:(n=(e=t.split(" ").map(function(t){return t.trim()}).filter(function(t){return t}))[0],r=b.call(e,1),e=/^[a-zA-Z]/.exec(n)?[n,""]:["",n],s+" :not("+i+") "+t+","+s+" > "+e[0]+":not("+i+")"+e[1]+" "+r.join(" "))}function d(t){return t+":"+u.style[t]+("important"===u.style.getPropertyPriority(t)?"!important":"")}function y(t){return t.trim()}function g(t){return e+"__"+t}function v(t){return t.cssText}},convert:function(t,e,n,r){var t="object"==typeof t?t:{name:t,css:e,rule:n,scopeTest:r},e=t.name,n=t.css,r=t.rule,t=t.scopeTest;return r=r||"."+e,e=e||r,t=t||this.scopeTest,this.node.textContent=n,n=this.getNames(this.node.sheet.rules,{}),this._convert(this.node.sheet.rules,r,e,t,n)}}),(s.manager=function(t){return null==t&&(t={}),this.attrName="csscope",this.converter=new s.converter,this.counter=0,t.registry&&this.registry(t.registry),this.init(),this}).prototype=t(Object.create(Object.prototype),{_reg:function(t){return"/assets/lib/"+t.name+"/"+(t.version||"latest")+"/"+(t.path||"")},registry:function(t){if(this._reg=t||"","string"==typeof this._reg&&this._reg&&"/"!==(t=this._reg)[t.length-1])return this._reg+="/"},getUrl:function(t){return null!=t.url?t.url:null!=t.name?"function"==typeof this._reg?this._reg({name:t.name,version:t.version,path:t.path}):this._reg+"/"+name+"/"+(version||"latest")+"/"+(path||""):t},init:function(){if(!this.inited)return this.inited=!0,this.styleNode=document.createElement("style"),this.styleNode.setAttribute("type","text/css"),this.styleNode.setAttribute("data-name","csscope.manager"),this.styleContent=[],document.body.appendChild(this.styleNode)},scope:function(t,e){e=this.get(e=null==e?[]:e);return t.classList.add.apply(t.classList,e.map(function(t){return t.scope})),e},get:function(t){var e=this;return null==t&&(t=[]),(Array.isArray(t)?t:[t]).map(function(t){return e.getUrl(t)}).map(function(t){return{url:t,scope:e.scope[t]}}).filter(function(t){return t.scope})},load:function(t,n){var r=this;return t=(Array.isArray(t)?t:[t]).map(function(t){return r.getUrl(t)}),Promise.all(t.map(function(e){return r.scope[e]="csp-"+r.counter+++"-"+Math.random().toString(36).substring(2).substring(5),ld$.fetch(e,{method:"GET"},{type:"text"}).then(function(t){t=r.converter.convert({css:t,name:r.scope[e],scopeTest:n});return r.styleContent.push(t)})})).then(function(){return r.styleNode.textContent=r.styleContent.join("\n")}).then(function(){return r.get(t)})}}),"undefined"!=typeof module&&null!==module?module.exports=s:"undefined"!=typeof window&&null!==window&&(window.csscope=s)}.call(this);
